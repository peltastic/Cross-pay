<div class="relative inline-block" (clickOutside)="isOpen = false">
  <button
    type="button"
    (click)="toggleDropdown()"
    [disabled]="disabled"
    class="flex items-center justify-between cursor-pointer gap-2 bg-white dark:bg-background-dark dark:border-0 border border-gray-background-1 rounded-lg shadow-sm focus:outline-none focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 backdrop-blur-sm"
    [class]="sizeClasses"
  >
    <span class="truncate text-black dark:text-white font-semibold">{{ selectedLabel || placeholder }}</span>
    <ng-icon
      name="heroChevronDownSolid"
      class="w-4 h-4 text-black dark:text-white! transition-transform duration-200"
      [class.rotate-180]="isOpen"
    />
  </button>

  @if (isOpen) {
  <div
    class="absolute z-[9999] mt-2 w-full bg-white dark:bg-background-dark dark:border-0 border border-gray-background-1 rounded-lg shadow-xl max-h-60 overflow-auto"
    (click)="$event.stopPropagation()"
  >
    <ul class="py-1">
      @for (option of options; track option.value; let i = $index) {
      <li
        (click)="selectOption(option); $event.stopPropagation()"
        (mousedown)="$event.preventDefault()"
        (mouseenter)="onMouseEnter(option)"
        (mouseleave)="onMouseLeave(option)"
        class="px-3 py-2 text-xs text-gray-text-1 dark:text-white cursor-pointer hover:bg-gray-background-1 dark:hover:bg-dark-hover-background  focus:outline-none transition-colors duration-150 select-none"
        [class.bg-indigo-100]="selectedValue === option.value"
        [class.dark:bg-indigo-900]="selectedValue === option.value"
        [class.opacity-50]="isOptionDisabled(option)"
        [class.cursor-not-allowed]="isOptionDisabled(option)"
        [attr.data-option]="option.value"
        [attr.data-index]="i"
      >
        {{ option.label }}
      </li>
      }
    </ul>
  </div>
  }
</div>
